<h1> AWS EC2, GitHub, Jenkins, Docker, Docker Hub, and Kubernetes</h1>

Certainly! Below is a comprehensive guide to setting up a full CI/CD pipeline using AWS EC2, GitHub, Jenkins, Docker, Docker Hub, and Kubernetes. This project will include setting up a simple web application, configuring a GitHub repository, setting up Jenkins to automate the build and deployment process, pushing the Docker image to Docker Hub, and deploying the application to a Kubernetes cluster.

### Step 1: Set up an AWS EC2 Instance

1. **Launch an EC2 Instance**:
   - Go to the AWS Management Console.
   - Navigate to the EC2 Dashboard and click on "Launch Instance".
   - Choose an Amazon Machine Image (AMI), preferably Ubuntu Server.
   - Select an instance type (t2.micro is usually sufficient for a small project).
   - Configure instance details, add storage, and add tags if necessary.
   - Configure the security group to allow HTTP (port 80), HTTPS (port 443), and SSH (port 22) access.
   - Review and launch the instance. Download the key pair (.pem file) if you don't already have one.

2. **Connect to Your Instance**:
   - Open your terminal.
   - Connect to the instance using SSH:
     ```bash
     ssh -i /path/to/your-key-pair.pem ubuntu@your-ec2-public-dns
     ```

### Step 2: Install Jenkins and Docker on the EC2 Instance

1. **Install Java**:
   ```bash
   sudo apt update
   sudo apt install openjdk-11-jdk -y
   ```

2. **Add Jenkins Repository and Install Jenkins**:
   ```bash
   wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
   sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
   sudo apt update
   sudo apt install jenkins -y
   ```

3. **Start Jenkins**:
   ```bash
   sudo systemctl start jenkins
   sudo systemctl enable jenkins
   ```

4. **Install Docker**:
   ```bash
   sudo apt install apt-transport-https ca-certificates curl software-properties-common -y
   curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
   sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
   sudo apt update
   sudo apt install docker-ce -y
   sudo usermod -aG docker $USER
   ```

5. **Restart Your Shell Session**:
   ```bash
   exit
   ssh -i /path/to/your-key-pair.pem ubuntu@your-ec2-public-dns
   ```

6. **Install Docker Compose**:
   ```bash
   sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
   sudo chmod +x /usr/local/bin/docker-compose
   ```

7. **Open Jenkins Web Interface**:
   - Open your browser and navigate to `http://your-ec2-public-dns:8080`.
   - Retrieve the initial admin password:
     ```bash
     sudo cat /var/lib/jenkins/secrets/initialAdminPassword
     ```
   - Follow the instructions to set up Jenkins and install the suggested plugins.

### Step 3: Set up a GitHub Repository

1. **Create a GitHub Repository**:
   - Go to GitHub and create a new repository (e.g., `simple-ci-cd-docker-k8s-project`).

2. **Clone the Repository to Your Local Machine**:
   ```bash
   git clone https://github.com/your-username/simple-ci-cd-docker-k8s-project.git
   cd simple-ci-cd-docker-k8s-project
   ```

3. **Add a Simple Dockerized Application**:
   - Create a simple Python web application (`app.py`):
     ```python
     from flask import Flask
     app = Flask(__name__)

     @app.route('/')
     def hello():
         return "Hello, World!"

     if __name__ == "__main__":
         app.run(host='0.0.0.0', port=5000)
     ```

   - Create a `Dockerfile`:
     ```Dockerfile
     FROM python:3.8-slim

     WORKDIR /app
     COPY app.py /app

     RUN pip install flask

     CMD ["python", "app.py"]
     ```

4. **Push Changes to GitHub**:
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

### Step 4: Set up Docker Hub Repository

1. **Create a Docker Hub Account**:
   - Go to Docker Hub and create an account if you don't already have one.

2. **Create a Repository**:
   - Create a new repository (e.g., `simple-ci-cd-docker-k8s-project`).

### Step 5: Install Kubernetes Tools

1. **Install kubectl**:
   ```bash
   sudo apt-get update
   sudo apt-get install -y apt-transport-https
   sudo curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
   echo "deb https://apt.kubernetes.io/ kubernetes-xenial main" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list
   sudo apt-get update
   sudo apt-get install -y kubectl
   ```

2. **Install Minikube**:
   ```bash
   curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
   sudo install minikube-linux-amd64 /usr/local/bin/minikube
   ```

3. **Start Minikube**:
   ```bash
   minikube start --driver=docker
   ```

### Step 6: Configure Jenkins for CI/CD with Docker, Docker Hub, and Kubernetes

1. **Install Jenkins Plugins**:
   - Go to "Manage Jenkins" > "Manage Plugins".
   - Install the following plugins:
     - Docker Pipeline
     - GitHub Integration Plugin
     - Pipeline Plugin
     - Kubernetes CLI Plugin

2. **Create a New Jenkins Pipeline Job**:
   - Go to the Jenkins dashboard.
   - Click on "New Item", enter a name for your job, select "Pipeline", and click "OK".

3. **Configure the Job**:
   - Under "Pipeline", select "Pipeline script from SCM".
   - Choose "Git" and enter your repository URL (e.g., `https://github.com/your-username/simple-ci-cd-docker-k8s-project.git`).
   - If your repository is private, you'll need to add your GitHub credentials.
   - Specify the script path as `Jenkinsfile`.

4. **Create a Jenkinsfile in Your Repository**:
   ```groovy
   pipeline {
       agent any

       environment {
           DOCKERHUB_CREDENTIALS = credentials('dockerhub-credentials')
           DOCKERHUB_REPO = 'your-dockerhub-username/simple-ci-cd-docker-k8s-project'
       }

       stages {
           stage('Checkout') {
               steps {
                   git 'https://github.com/your-username/simple-ci-cd-docker-k8s-project.git'
               }
           }
           stage('Build Docker Image') {
               steps {
                   script {
                       dockerImage = docker.build("${env.DOCKERHUB_REPO}:${env.BUILD_ID}")
                   }
               }
           }
           stage('Push Docker Image') {
               steps {
                   script {
                       docker.withRegistry('https://index.docker.io/v1/', 'dockerhub-credentials') {
                           dockerImage.push("${env.BUILD_ID}")
                           dockerImage.push("latest")
                       }
                   }
               }
           }
           stage('Deploy to Kubernetes') {
               steps {
                   script {
                       sh """
                       kubectl set image deployment/simple-ci-cd-deployment simple-ci-cd-container=${env.DOCKERHUB_REPO}:${env.BUILD_ID}
                       """
                   }
               }
           }
       }
   }
   ```

5. **Add Docker Hub Credentials to Jenkins**:
   - Go to "Manage Jenkins" > "Manage Credentials".
   - Add a new set of credentials for Docker Hub with your Docker Hub username and password.
   - Give it an ID (e.g., `dockerhub-credentials`).

6. **Create Kubernetes Deployment and Service Files**:
   - Create a Kubernetes deployment file (`deployment.yaml`):
     ```yaml
     apiVersion: apps/v1
     kind: Deployment
     metadata:
       name: simple-ci-cd-deployment
     spec:
       replicas: 1
       selector:
         matchLabels:
           app: simple-ci-cd
       template:
         metadata:
           labels:
             app: simple-ci-cd
         spec:
           containers:
           - name: simple-ci-cd-container
             image: your-dockerhub-username/simple-ci-cd-docker-k8s-project:latest
             ports:
             - containerPort: 5000
     ```

   - Create a Kubernetes service file (`service.yaml`):
     ```yaml
     apiVersion: v1
     kind: Service
     metadata:
       name: simple-ci-cd-service
     spec:
       type: NodePort
       selector:
         app: simple-ci-cd
      
